{% extends 'base_fragment.html' %}
{% block content %}
<div class="container dashboard">
  <div class="section-card">
    <div class="dashboard-header">
      <div>
        <p class="hero-kicker">O'qituvchi paneli</p>
        <h1 class="section-title">Teacher Dashboard</h1>
        <p class="section-text">Resurslarni boshqarish, testlarni ko'rish va so'nggi urinishlarni kuzatish uchun tezkor panel.</p>
      </div>
      <div class="cta-actions">
        <a class="btn btn-accent" href="{% url 'core:tests_list' %}">Testlar ro'yxati</a>
      </div>
    </div>
  </div>

  <div class="section-grid">
    <div class="section-card">
      <h2 class="section-title">Testlar</h2>
      <p class="section-text">Mavjud testlar va savollar soni.</p>
      <ul class="section-list">
        {% for t in tests %}
          <li>
            <a href="{% url 'core:test_take' t.pk %}">{{ t.title }}</a> â€” {{ t.questions.count }} savol
            {% if request.user.is_staff %}
              &nbsp; <a href="{% url 'core:test_edit' t.pk %}">[sozlamalar]</a>
            {% endif %}
          </li>
        {% empty %}
          <li>Hozircha testlar yo'q.</li>
        {% endfor %}
      </ul>
    </div>

    <div class="section-card">
      <h2 class="section-title">So'nggi urinishlar</h2>
      <div class="table-wrap">
        <table class="dashboard-table">
          <thead>
            <tr>
              <th>Talaba</th>
              <th>Test</th>
              <th>Natija</th>
              <th>Boshlanish</th>
              <th>Tugash</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for a in recent_attempts %}
            <tr>
              <td>{% if a.user %}{{ a.user.username }}{% else %}Anonymous{% endif %}</td>
              <td>{{ a.test.title }}</td>
              <td>{{ a.score }} / {{ a.max_score }}</td>
              <td>{{ a.started_at }}</td>
              <td>{{ a.finished_at }}</td>
              <td><a class="btn btn-sm btn-accent-outline" href="{% url 'core:review_attempt_detail' a.pk %}">Review</a></td>
            </tr>
            {% empty %}
            <tr><td colspan="6">Hozircha urinishlar yo'q.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
