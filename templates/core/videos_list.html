{% extends "base_fragment.html" %}
{% load video_tags %}
{% block content %}
  <div class="container">
    <h2>Video ma'ruzalar</h2>
    <p>
      {% if user.is_staff or user.is_superuser %}
        <a class="btn" href="{% url 'core:video_add' %}">Yangi video yuklash (admin)</a>
      {% endif %}
    </p>
    <div class="section-grid">
      {% for v in videos %}
        <div class="section-card">
          <h3 class="section-title">{{ v.title }}</h3>
          {% if v.description %}
            <p class="section-text">{{ v.description }}</p>
          {% endif %}
          {% if v.url %}
            <div class="mt-3">
              <a class="btn btn-accent-outline btn-sm" href="{{ v.url }}" target="_blank" rel="noopener">Darsni koâ€˜rish</a>
            </div>
          {% elif v.file %}
            <video controls style="max-width:100%">
              <source src="{{ v.file.url }}">
              Sizning brauzeringiz video tegini qo'llab-quvvatlamaydi.
            </video>
          {% else %}
            <p class="text-warning">Video havolasi yoki fayl biriktirilmagan.</p>
          {% endif %}
          <div class="mt-3 d-flex align-items-center justify-content-between">
            <small class="text-muted">{{ v.created_at|date:'Y-m-d' }}</small>
            <a class="btn btn-accent-outline btn-sm" href="{% url 'core:video_detail' v.pk %}">Batafsil</a>
          </div>
        </div>
      {% empty %}
        <div class="section-card">Hozircha hech qanday video mavjud emas.</div>
      {% endfor %}
    </div>
  </div>
{% endblock %}
